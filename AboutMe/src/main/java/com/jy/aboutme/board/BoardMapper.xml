<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Config 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.jy.aboutme.board.BoardMapper">

	<!--  테스트@@@@@@@@@@@@@@@@ board detail 다되면 지우기-->
	<select id="test" resultType="BoardPARAM" parameterType="BoardPARAM">
		SELECT ctnt FROM t_board
		WHERE i_board = #{i_board}
	</select>
	<!-- 테스트용@@@@@@@@@@@@@@@@@@@ -->


	<!-- 게시글 전체 리스트 -->
	<select id="boardList" resultType="BoardPARAM">
		SELECT i_board, nm, title, ctnt, pw, scr, r_dt
		FROM t_board
		ORDER BY r_dt DESC
	</select>
	
	
	
		
	<!-- 작성자 검색 -->
	<!-- 여기서 하나로 묶기!! -->
	<select id="searchNm" parameterType="BoardPARAM" resultType="BoardPARAM">
		SELECT i_board, nm, title, ctnt, pw, scr, r_dt FROM t_board
		WHERE nm LIKE CONCAT('%', #{search}, '%')
	</select>
	
	<!-- 제목 검색 -->
	<select id="searchTitle" parameterType="BoardPARAM" resultType="BoardPARAM">
		SELECT i_board, nm, title, ctnt, pw, scr, r_dt FROM t_board
		WHERE title LIKE CONCAT('%', #{search}, '%')
	</select>
	
	
	

	<!-- 게시글 상세페이지 -->
	<select id="boardDetail" parameterType="BoardPARAM" resultType="BoardPARAM">
		SELECT i_board, nm, title, pw, ctnt, r_dt FROM t_board
		WHERE i_board = #{i_board} 
	</select>
	
	
	<!-- 비밀번호 맞추기 (게시글) -->
	<select id="selScr" parameterType="BoardPARAM" resultType="BoardDMI">
		SELECT pw FROM t_board
		WHERE i_board = #{i_board}
	</select>
	
	
	<!-- 게시글 등록
		 마지막에 insert 된 i_board값을 반환한다
	 -->	
	<insert id="insReg" parameterType="BoardPARAM">		
		INSERT INTO t_board
		(nm, title, ctnt, pw, scr)
		VALUES
		(#{nm}, #{title}, #{ctnt}, #{pw}, #{scr})
		<selectKey resultType="integer" keyProperty="i_board" order="AFTER">
			SELECT LAST_INSERT_ID()
		</selectKey>
	</insert>
	 
	 
	 
	
	<update id="updReg" parameterType="BoardPARAM">
		UPDATE t_board
		SET nm = #{nm},
		title = #{title},
		ctnt = #{ctnt},
		pw = #{pw},
		scr = #{scr}
		WHERE i_board = #{i_board}
	</update>
	
	
	
</mapper>